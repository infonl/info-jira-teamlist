/*

Show a list of team members 
- can be used during standup
- can differ per day of the week 


Settings in "User Javascript and CSS" plugin
Name: Teams JS
URLs: jira.*RapidBoard.jsp*
Options
- Javascript
- Libraries jQuery 3

*/
function appendMemberList() {

	var oDate = new Date();
	var dayOfTheWeek = oDate.getDay();
	var amemberList = [];
	amemberList[1] = "Ni Ri Ad Ge Is Ja (Ke) Lb Mar Hr (PO)"; // mon
	amemberList[2] = "Ni (Pa) Ri Ad Ge Is Ja Lb Mar Mau Hr (PO)"; // tue
	amemberList[3] = "Ni Ri Ad Ge Is Ja Lb Mau Hr (PO)"; // wed
	amemberList[4] = "Ni (Pa) Ri Ad Ge Is Ja (Ke) Lb Mar Mau Hr (PO)"; // thu
	amemberList[5] = "Ni (Pa) Ri Ad Ge Is Ja (Ke) Lb Mar Mau"; // fri
	amemberList[6] = "enjoy_the_weekend"; // Sat
	amemberList[0] = "enjoy_the_weekend"; // Sun
	
	var aMemberList = amemberList[dayOfTheWeek].split(" ");
	//shuffleArray(aMemberList); // shuffles the list
	var memberList = aMemberList.join(" ");
	
	$('.ghx-column:nth-child(1) .ghx-column-title').html("To Do --- " + memberList );

}

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

(function () {

	// wait 2 secs for the navbar / header to popup
	setTimeout(function() {
				$('.aui-nav-item').on('click', function () {
			// click on Backlog view button
			//if ($.contains(this, $('.agile-icon-plan').get(0))) {
				setTimeout(function () {
					appendMemberList();
				}, 1200);
		//	}
		});
		
		// reinitiate after change of Quick filter or Release/Epic
		$(document).on('click', '.js-quickfilter-button, .ghx-classification-item', function (e) {
			clearTimeout(timer);
			timer = setTimeout(function() {
				appendMemberList();
			}, 2000)
		})	
		
		// reinitiate after Click on issue
		$(document).on('click', '.ghx-issue', function (e) {
			clearTimeout(timer);
			timer = setTimeout(function() {
				appendMemberList();
			}, 1000)
		})	
		
		// reinitiate after moving an issue
		$(document).on('mouseout', '.ghx-issue', function (e) {
			clearTimeout(timer);
			timer = setTimeout(function() {
				appendMemberList();
			}, 500)
		})	
		
		appendMemberList();
	}, 2000); // wait for ajax-list to be loaded.. if link fails to show: increase amount here
})();
